---
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../consts';

const BUTTON_TEXT = 'Buy Astrolabe Elements Pendant - $35';
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
	</head>
	<body>
		<Header />
		<main>
			<div class="w-full">
				<img src="/magitech-transparent.png" alt="Magitech Logo" style="width: 300px; display: block; margin: 0 auto;" class="h-auto" />
			</div>
			<div style="display: flex; justify-content: center; gap: 1rem; margin-top: 2rem; max-width: 2000px; margin-left: auto; margin-right: auto; flex-wrap: wrap;">
				<img src="/astrolabe-elements-package.png" alt="Astrolabe Elements Package" style="max-height: 450px; width: auto; object-fit: contain;" />
				<img src="/astrolabe-elements-documentation.png" alt="Astrolabe Elements Documentation" style="max-height: 450px; width: auto; object-fit: contain;" />
			</div>
			<div style="text-align: center; margin-top: 2rem;">
				<a 
					id="add-to-cart-btn"
					href="#"
					style="display: inline-block; background-color: #635BFF; color: white; padding: 1rem 2rem; border-radius: 0.5rem; text-decoration: none; font-weight: bold; transition: background-color 0.2s;"
				>
					{BUTTON_TEXT}
				</a>
			</div>
			
			<div style="max-width: 600px; margin: 4rem auto; padding: 0 1rem; text-align: center;">
				<h2 style="margin-bottom: 1rem;">stay updated on new art</h2>
				<form
					action="https://buttondown.com/api/emails/embed-subscribe/astrolabist"
					method="post"
					target="popupwindow"
					onsubmit="window.open('https://buttondown.com/astrolabist', 'popupwindow')"
					class="embeddable-buttondown-form"
					style="display: flex; flex-direction: column; gap: 1rem; align-items: center;"
				>
					<label for="bd-email" style="font-weight: bold;">Enter your email</label>
					<input 
						type="email" 
						name="email" 
						id="bd-email" 
						style="padding: 0.5rem; border: 1px solid #ccc; border-radius: 0.25rem; width: 100%; max-width: 300px;"
						required
					/>
					
					<input 
						type="submit" 
						value="Subscribe" 
						style="background-color: #635BFF; color: white; padding: 0.75rem 1.5rem; border: none; border-radius: 0.25rem; cursor: pointer; font-weight: bold;"
					/>
					<p style="font-size: 0.875rem; color: #666;">
						<a href="https://buttondown.com/refer/astrolabist" target="_blank" style="color: #635BFF;">Powered by Buttondown.</a>
					</p>
				</form>
			</div>
			
			<div style="max-width: 800px; margin: 4rem auto; padding: 0 1rem; text-align: center;">
				<h2 style="margin-bottom: 1.5rem;">my lightning talk about the astrolabe</h2>
				<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%;">
					<iframe 
						src="https://www.youtube.com/embed/h0MUKPhJaUQ" 
						style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0;"
						title="Astrolabe Lightning Talk"
						allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
						allowfullscreen
					></iframe>
				</div>
			</div>
		</main>
		<Footer />
		<script type="module" client:load define:vars={{ BUTTON_TEXT }}>
			import { Cart } from '../cart.js';
			
			// Function to handle adding to cart
			function addToCart(event) {
				event.preventDefault();
				Cart.addItem('prod_SDOil8nBU1UUGg');
				const link = document.getElementById('add-to-cart-btn');
				if (link) {
					link.textContent = 'Added to Cart';
					link.style.backgroundColor = '#4CAF50';
					setTimeout(() => {
						if (link) {
							link.textContent = BUTTON_TEXT;
							link.style.backgroundColor = '#635BFF';
						}
					}, 2000);
				}
			}

			// Add click event listener when the script loads
			document.addEventListener('DOMContentLoaded', () => {
				const link = document.getElementById('add-to-cart-btn');
				if (link) {
					link.addEventListener('click', addToCart);
				}
			});
		</script>
	</body>
</html>
